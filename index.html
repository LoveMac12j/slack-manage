<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>slack api リンク生成</title>
<style>
</style>
<script>
window.addEventListener("load", init)
function init() {
  tokenDom = document.getElementById('token');
  chDom = document.getElementById('ch');
  txtDom = document.getElementById('txt');
  tsDom = document.getElementById('ts');
  //ここから結果表示関連
  urlDom = document.getElementById('urlView');
  btnDom = document.getElementById('start');
  btnDom.addEventListener("click", start);
  linkDom = document.getElementById('link');
}
function start() {
  let url;
  if (ts.value == "") {
    url = "https://slack.com/api/chat.postMessage?token=" + tokenDom.value + "&channel=" + chDom.value + "&text=" + txtDom.value;
  } else {
    url = "https://slack.com/api/chat.postMessage?token=" + tokenDom.value + "&channel=" + chDom.value + "&text=" + txtDom.value + "&thread_ts=" + ts.value;
  }
  urlDom.value = encodeURI(url);
  let link = "<a href='" + url + "'>Or click the link to run it quickly.</a>"
  linkDom.innerHTML = link;
}
</script>
</head>
<body>
  ここにBot User OAuth Access Tokenを入力してください...<br>
  <input type="text" id="token">
  <br>
  (参考)<a href="https://api.slack.com">SLACK API</a>
  <br>
  ここにChannel名を入力してください...<br>
  <input type="text" id="ch">
  <br>
  (参考)<a href="https://tech-unlimited.com/urlencode.html">URLエンコーダ</a>
  <br>
  ここに送信したいテキストを入力してください...<br>
  <textarea id="txt" rows="8" cols="80"></textarea>
  <br>
  ここにts(thread_ts)を入力してください...(ない場合は何も入れない)<br>
  <input type="text" id="ts">
  <br>
  <br>
  <br>
  <br>
  完了したら以下のボタンを押し、表示されたURLをブラウザのURL窓にコピーアンドペーストしてください。<br>
  <input type="button" id="start" value="START">
  <br>
  <input type="text" id="urlView">
  <div id="link">
  </div>
  <br>
  <br>
  <br>
  --注意事項--<br>
  1. 改行したい際はこちらをコピーアンドペーストしてください。<br>
  %0D%0A<br>
  <br>
  2. 'や?などの記号は全角にすることで正しく利用できる場合がございます。<br>
  <br>
  3. 続けてメッセージを送信する場合はCMD+クリックまたは新規タブで開くを選択して開いてください。<br>
  タブを操作することで1回目の続きから操作できます。<br>
  <br>
  4. リンクを開いてok:trueが表示されたら次の操作に移る前に必ずCMD+Wまたはタブのxボタンでタブを閉じてください。<br>
  次回ブラウザを開いた際に再読み込みされ、意思に沿わないメッセージが複数回送信されてしまう恐れがあります。
</body>
</html>
